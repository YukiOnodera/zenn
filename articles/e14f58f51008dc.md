---
title: e14f58f51008dc
created: 2023-12-13 19:18:29
updated: 2023-12-14 10:14:53
tags: 
aliases: 
emoji: ğŸ¤–
published: false
topics: 
type: tech
---
# ã¯ã˜ã‚ã«
Terragrunt ã§Planã—ãŸã‚‰EKSå‘¨ã‚Šã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§å¯¾å‡¦æ³•ã¾ã¨ã‚ã¾ã™ã€‚

# å•é¡Œ
ä¸‹è¨˜ã®ï¼’ä»¶ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚
EKS ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å©ã„ã¦ã„ã‚‹ã¹ããªã®ã«ã€localhost ã«ãªã£ã¦ã„ã‚‹ã€ã€ï¼Ÿ
```shell
â•·
â”‚ Error: Get "http://localhost/api/v1/namespaces/aws-observability": dial tcp [::1]:80: connect: connection refused
â”‚
â”‚   with module.eks_blueprints_addons.kubernetes_namespace_v1.aws_observability[0],
â”‚   on .terraform/modules/eks_blueprints_addons/main.tf line 2545, in resource "kubernetes_namespace_v1" "aws_observability":
â”‚ 2545: resource "kubernetes_namespace_v1" "aws_observability" {
â”‚
â•µ
```
```shell
â”‚ Error: Get "http://localhost/api/v1/namespaces/aws-observability/configmaps/aws-logging": dial tcp [::1]:80: connect: connection refused
â”‚
â”‚   with module.eks_blueprints_addons.kubernetes_config_map_v1.aws_logging[0],
â”‚   on .terraform/modules/eks_blueprints_addons/main.tf line 2558, in resource "kubernetes_config_map_v1" "aws_logging":
â”‚ 2558: resource "kubernetes_config_map_v1" "aws_logging" {
â”‚
â•µ
```

å¯¾è±¡ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’state ã‹ã‚‰å‰Šé™¤ã—ãŸã‚‰ã€ã¨ã‚Šã‚ãˆãšPlanã¯é€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ãŒã€Apply ã§çµå±€ä¼¼ãŸã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚
# è§£æ±ºæ–¹æ³•

provider ã®è¨­å®šã‚’è¦‹ç›´ã™ã¨ã„ã„ã¨æ€ã„ã¾ã™ã€‚(æœ€åˆã‹ã‚‰ã“ã£ã¡ã§è‰¯ã‹ã£ãŸ)

ä¸‹è¨˜ã¯ä¸€ä¾‹ã§ã™ã€‚
```hcl
provider "kubernetes" {
host = module.eks.cluster_endpoint
cluster_ca_certificate = base64decode(module.eks.cluster_certificate_authority_data)
exec {
api_version = "client.authentication.k8s.io/v1beta1"
args = ["eks", "get-token", "--cluster-name", module.eks.cluster_name]
command = "aws"
}
# config_path = "~/.kube/config"
# config_context = module.eks.cluster_arn
}
```
# ãŠã‚ã‚Šã«
ã‚¨ãƒ©ãƒ¼ã§æ¤œç´¢ã—ãŸã‚‰è‹±èªã®Discussionã°ã£ã‹ã§ã¡ã‚‡ã£ã¨å¤§å¤‰ã ã£ãŸã€‚
ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸæ™‚ã«ã€ãªãœã‹localhost ã«æ¥ç¶šã—ã¦ã„ã‚‹ã“ã¨ã«é•å’Œæ„Ÿã‚’æŒã£ã¦ã€ãã“ã‹ã‚‰Provider ã®è¨­å®šã‚’ç–‘ã£ã¦ã„ã‚Œã°æ™‚é–“æµªè²»ã›ãšã«ã™ãã«å¯¾å‡¦ã§ããŸã‹ã‚‚ã€‚

# å‚è€ƒ

```cardlink
url: https://github.com/cloudposse/terraform-aws-eks-cluster/issues/143
title: "Error: Get \"http://localhost/api/v1/namespaces/kube-system/configmaps/aws-auth\" Â· Issue #143 Â· cloudposse/terraform-aws-eks-cluster"
description: "Found a bug? Maybe our Slack Community can help. Describe the Bug I noticed that if the eks cluster is switching subnets, particularly public + private, to only private, the eks cluster will return..."
host: github.com
favicon: https://github.githubassets.com/favicons/favicon.svg
image: https://opengraph.githubassets.com/779eaa8d5425907c21cc4ce6223305550bcc66bc81bf87fdd096a566a5efe706/cloudposse/terraform-aws-eks-cluster/issues/143
```
[Error: Get "http://localhost/api/v1/namespaces/kube-system/configmaps/aws-auth" Â· Issue #143 Â· cloudposse/terraform-aws-eks-cluster Â· GitHub](https://github.com/cloudposse/terraform-aws-eks-cluster/issues/143)


```cardlink
url: https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs
title: "Terraform Registry"
host: registry.terraform.io
favicon: https://registry.terraform.io/images/favicons/favicon-32x32.png
```
[Terraform Registry](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs)

```cardlink
url: https://github.com/hashicorp/terraform-provider-helm/issues/893
title: "2.6.0 provider version causing `Error: Kubernetes cluster unreachable: exec plugin: invalid apiVersion` Â· Issue #893 Â· hashicorp/terraform-provider-helm"
description: "âš ï¸ NOTE FROM MAINTAINERS âš ï¸ v1alpha1 of the client authentication API was removed in the Kubernetes client in version 1.24. The latest release of this provider was updated to use 1.24 of the Kubern..."
host: github.com
favicon: https://github.githubassets.com/favicons/favicon.svg
image: https://opengraph.githubassets.com/7c9e50273776686aa8f6ccaf934975956867904ef8c44c5c9f26a281d6b1d8d6/hashicorp/terraform-provider-helm/issues/893
```
[2.6.0 provider version causing \`Error: Kubernetes cluster unreachable: exec plugin: invalid apiVersion\` Â· Issue #893 Â· hashicorp/terraform-provider-helm Â· GitHub](https://github.com/hashicorp/terraform-provider-helm/issues/893)